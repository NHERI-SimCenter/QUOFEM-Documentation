
Shear Building: Sampling, Reliability and Sensitivity
=====================================================

Consider the problem of uncertainty quantification in a three story shear building

.. figure:: figures/shear.png
   :align: center
   :width: 600
   :figclass: align-center

   Three Story Shear Building Model (P10.2.9, "Dynamics of Structures", A.K.Chopra)

The structure has uncertain properties that all follow normal distribution:

1. Weight of Typical Floor(w): mean :math:`\mu_E=100 kip` and standard deviation :math:`\sigma_E =10 kip` (COV = 10%)
2. Weight of Roof(wR): mean :math:`\mu_E=50 kip` and standard deviation :math:`\sigma_E =5 kip` (COV = 10%)
2. Story Stiffness (k): mean :math:`\mu_k =326.32 kip/in` and a standard deviation of :math:`\sigma_P = 3 kN`, (COV = 12%).

The goal of the exercise is to estimate the mean and standard deviation of the relative displacement of node **4** when subject to:
1. ElCentro ground motion
2. ElCEntro & Rinaldi E and W components.
3. A Selection of ground motions selected from the PEER NGA database.

The exercise will use both the MDOF, :numref:`lblMDOF`,  and OpenSees, :numref:`lblOpenSeesSIM`, structural generators. For the OpenSees generator the following model script, `ShearBuilding3.tcl <https://github.com/NHERI-SimCenter/EE-UQ/blob/master/Examples/ShearBuilding3/ShearBuilding3.tcl>`_ :

.. literalinclude:: ShearBuilding3.tcl
   :language: tcl

.. note::
   
   1. The first lines containing pset will be read by the application when the file is selected and the application will autopopulate the Random Variables w, wR, and k in RV input panel with these same variable names. It is of course possible to explicitly use Random Variables without the pset command by "RV.**variable name" in the input file. However, no random variables will be autopopulated if user chooses this route.

.. warning::

   Do not place the file in your root, downloads, or desktop folder as when the application runs it will copy the contents on the directories and subdirectories containig this file multiple times (a copy will be made for each sample specified). If you are like us, your root, Downloads or Documents folders contains and awful lot of files and when the backend workflow runs you will slowly find you will run out of disk space!

Sampling Analysis
^^^^^^^^^^^^^^^^^

To perform a Sampling or Forward propogation uncertainty analysis the user would perform the following steps:

The steps involved:

1. Start the application and the UQ Selection will be highlighted. In the panel for the UQ selection, keep the UQ engine as that selected, i.e. Dakota, and the UQ Method Category as Forward Propogation, and the Forward Propagarion method as LHS (Latin Hypercude). Change the #samples to 1000 and the seed to 20 as shown in the figure.

.. figure:: figures/shearUQ.png
   :align: center
   :figclass: align-center

2. Next select the FEM tab from the input panel. This will default in the MDOF engine. We will use this engine (the NOTE below contains instruction on how to use the OpenSees scipt instead). In the building information panel, specify number of stories as **3** (this will change the graphic). Also in the Building information frame specify **w** for the floor weights and **k** for story stiffness. Finally in the tabvle below, go to the third row and enter **wR** for the roof weight (you will notice that when you enter that table cell the node at the top of the model will turn red, indicating you are editing the information for the top most node).

.. figure:: figures/shearSIM.png
   :align: center
   :figclass: align-center

3. Next select the RV tab from the input panel. This should be prepopulated with four random variables with same names as those having pset in the tcl script. For each variable, from the drop down menu change them from having a constant distribution to a normal one and then provide the means and standard deviations specified for the problem.

.. figure:: figures/trussRV.png
   :align: center
   :figclass: align-center

4. Next select the QoI panel. Here enter 'Node_3_Disp_2' for the one variable. 

.. figure:: figures/trussQoI.png
   :align: center
   :figclass: align-center
.. note::

.. note::   

   The user can add additional QoI by selecting add and then providing additional names. As seen from the postprocess script any of the 6 nodes may be specified and for any node either the 1 or 2 dof direction.

5. Next click on the 'Run' button. This will cause the backend application to launch dakota. When done the RES panel tab will be selected and the results will be displayed. The results show the values the mean and standard deviation.

.. figure:: figures/trussRES1.png
   :align: center
   :figclass: align-center


If the user selects the "Data" tab in the results panel, they will be presented with both a graphical plot and a tabular listing of the data.

.. figure:: figures/trussRES2.png
   :align: center
   :figclass: align-center

Various views of the graphical display can be obtained by left and right clicking in the columns of the tabular data. If a singular column of the tabular data is pressed with both right and left buttons a freequency and CDF will be displayed, as shown in figure below.

.. figure:: figures/trussRES5.png
   :align: center
   :figclass: align-center

Reliability Analysis
^^^^^^^^^^^^^^^^^^^^

If the user is interested in the probability that certain response measure will be exceeded an alternative strategy is to perform a reliability analysis. To perform a reliability analysis the steps above would be repeated with the exception that the user would select a reliability analysis method instead of a Forward Propogation method. To obtain reliability results using the Second-Order Reliability Method (SORM) for the truss problem the user would follow the same sequence of steps as previously. The difference would be in the UQ tab in which the user would select a Reliability as the Dakota Method Catagory and then choose Local reliability. In the figure the user is specifying that they are interetsed in the probability that the displacement will exceed certain response levels.


.. figure:: figures/trussSORM-UQ.png
   :align: center
   :figclass: align-center

After the user fills in the rest of the tabs as per the previous section, the user would then press the ''RUN'' button. The application (after spinning for a while with the wheel of death) will present the user with the results.

.. figure:: figures/trussSORM-RES.png
   :align: center
   :figclass: align-center


Global Sensitivity
^^^^^^^^^^^^^^^^^^

In a global sensitivity analysis the user is wishing to understand what is the influence of the individual random variables on the quantities of interest. This is typically done before the user launches large scale forward uncertainty problems in order to limit the number of random variables used so as to limit the number of simulations performed.

To perform a reliability analysis the steps above would be repeated with the exception that the user would select a reliability analysis method instead of a Forward Propogation method. To obtain reliability results using the Second-Order Reliability Method (SORM) for the truss problem the user would follow the same sequence of steps as previously. The difference would be in the UQ tab in which the user would select a Reliability as the Dakota Method Catagory and then choose Local reliability. In the figure the user is specifying that they are interetsed in the probability that the displacement will exceed certain response levels.


.. figure:: figures/trussSens-UQ.png
   :align: center
   :figclass: align-center

After the user fills in the rest of the tabs as per the previous section, the user would then press the ''RUN'' button. The application (after spinning for a while with the wheel of death) will present the user with the results.

.. figure:: figures/trussSensitivity-RES.png
   :align: center
   :figclass: align-center








